import{M as K,N as v,O as M,P as _,Q as ee,T as te,r as u,E as H,j as e,q as re,U as ae,V as R,W as F,X as W,L as se}from"./index-BoN5T6-R.js";import{I as j}from"./index-t7jTpxbe.js";import{c as N,B as m}from"./index-B0KVRp8-.js";import{u as ne,F as ie,a as y,C as G,t as oe,o as le,s as E,b as ce}from"./useTimeOutMessage-Dy6Y6LI1.js";import{P as de}from"./PasswordInput-mgDvkTjG.js";import{A as ue}from"./ActionLink-BfJIqeFM.js";import"./classNames-B625GU31.js";import"./index-BUAPYiFd.js";const V=new ee;V.setCustomParameters({prompt:"select_account"});const B=new te;B.setCustomParameters({allow_signup:"true",prompt:"consent"});async function me(){try{return await _(v,V)}catch(t){throw console.error("Google sign-in error:",t),new Error(t.message||"Google sign-in failed")}}async function he(){try{console.log("Opening GitHub sign-in popup...");const t=await _(v,B);return console.log("GitHub sign-in successful:",t.user.email),t}catch(t){throw console.error("GitHub sign-in error:",t),new Error(t.message||"GitHub sign-in failed")}}let k=null;async function pe(t){return k||(k=new K(v,"recaptcha-container",{size:"invisible",callback:()=>{console.log("reCAPTCHA solved")}})),await M(v,t,k)}async function xe(t,r){return await t.confirm(r)}async function S(t){return await t.user.getIdToken()}const ge=le({email:E({required_error:"Please enter your email"}).min(1,{message:"Please enter your email"}),password:E({required_error:"Please enter your password"}).min(1,{message:"Please enter your password"})}),fe=t=>{var A,O;const[r,n]=u.useState(!1),[o,l]=u.useState("email"),[i,h]=u.useState(""),[s,p]=u.useState(""),[c,I]=u.useState(null),[P,f]=u.useState(""),{disableSubmit:U=!1,className:D,setMessage:d,passwordHint:T}=t,{handleSubmit:L,formState:{errors:b},control:C}=ne({defaultValues:{email:"",password:""},resolver:oe(ge)}),{signIn:q,oAuthSignIn:z}=H(),Z=async a=>{const{email:x,password:w}=a;if(!U){n(!0);const g=await q({email:x,password:w});(g==null?void 0:g.status)==="failed"&&(d==null||d("invalid credentials"))}n(!1)},Q=async()=>{if(!i){f("Please enter a phone number");return}f(""),n(!0);try{const a=i.startsWith("+91")?i:`+91${i}`,x=await pe(a);I(x),d==null||d("OTP Sent!")}catch(a){console.error("Error sending OTP:",a),f(a.message||"Failed to send OTP")}finally{n(!1)}},X=async()=>{if(!(!s||!c)){n(!0);try{const a=await xe(c,s),x=await S(a),w=await ae({id_token:x});if(w){const{token:g,user:Y}=w;z(({onSignIn:$,redirect:J})=>{$({accessToken:g},Y),J()})}}catch(a){console.error("Error verifying OTP:",a),f(a.message||"Failed to verify OTP")}finally{n(!1)}}};return e.jsxs("div",{className:N(D,"animate-in fade-in slide-in-from-bottom-4 duration-700"),children:[e.jsxs("div",{className:"flex p-1.5 bg-white/5 border border-white/5 rounded-2xl mb-8",children:[e.jsx("button",{className:N("flex-1 flex items-center justify-center gap-2 py-3 text-xs font-bold tracking-widest uppercase transition-all duration-300 rounded-xl rounded-r-none",o==="email"?"bg-primary text-black shadow-[0_0_20px_rgba(34,197,94,0.3)]":"text-gray-100 hover:text-gray-100"),onClick:()=>l("email"),children:"Email Access"}),e.jsx("button",{className:N("flex-1 flex items-center justify-center gap-2 py-3 text-xs font-bold tracking-widest uppercase transition-all duration-300 rounded-xl rounded-l-none",o==="phone"?"bg-primary text-black shadow-[0_0_20px_rgba(34,197,94,0.3)]":"text-gray-100 hover:text-gray-100"),onClick:()=>l("phone"),children:"Secure SMS"})]}),e.jsx("div",{className:"space-y-6",children:o==="email"?e.jsxs(ie,{onSubmit:L(Z),children:[e.jsx(y,{label:e.jsx("span",{className:"text-gray-100 text-[10px] font-bold tracking-widest uppercase",children:"Email Address"}),invalid:!!b.email,errorMessage:(A=b.email)==null?void 0:A.message,children:e.jsx(G,{name:"email",control:C,render:({field:a})=>e.jsx(j,{type:"email",className:"h-12 bg-white/5 border-white/10 rounded-xl focus:border-primary/50 text-gray-100 placeholder:text-gray-300/60 transition-all font-medium pr-10",placeholder:"commander@poselab.gg",autoComplete:"off",...a})})}),e.jsx(y,{label:e.jsx("span",{className:"text-gray-100 text-[10px] font-bold tracking-widest uppercase",children:"Secret Password"}),invalid:!!b.password,errorMessage:(O=b.password)==null?void 0:O.message,className:re(T?"mb-0":""),children:e.jsx(G,{name:"password",control:C,rules:{required:!0},render:({field:a})=>e.jsx(de,{placeholder:"••••••••",...a})})}),e.jsx("div",{className:"flex justify-start",children:T}),e.jsx(m,{variant:"default",type:"submit",className:"w-full h-12 bg-primary hover:bg-primary text-black font-bold rounded-xl shadow-xl shadow-primary/10 transition-all hover:scale-[1.02] active:scale-95 duration-200 mt-4",disabled:r,children:r?"AUTHORIZING...":"SIGN IN TO STUDIO"})]}):e.jsx("div",{className:"space-y-6",children:c?e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(y,{label:e.jsx("span",{className:"text-gray-400 text-[10px] font-bold tracking-widest uppercase",children:"Verification Code"}),children:e.jsx(j,{className:"h-14 text-center text-3xl font-black tracking-[0.5em] bg-white/5 border-white/10 rounded-xl focus:border-primary/50 text-primary placeholder:text-gray-800 transition-all",placeholder:"000000",maxLength:6,value:s,onChange:a=>p(a.target.value)})}),e.jsx(m,{className:"w-full h-12 bg-primary hover:bg-primary text-black font-bold rounded-xl shadow-xl shadow-primary/10 transition-all hover:scale-[1.02] active:scale-95 duration-200",onClick:X,disabled:r,children:r?"VERIFYING...":"COMPLETE AUTHORIZATION"}),e.jsx(m,{variant:"ghost",size:"sm",className:"w-full text-xs text-gray-500 hover:text-white hover:bg-white/5 h-10 rounded-xl font-bold tracking-widest uppercase",onClick:()=>I(null),children:"Change Phone"})]}):e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(y,{label:e.jsx("span",{className:"text-gray-100 text-[10px] font-bold tracking-widest uppercase",children:"Phone "}),invalid:!!P,errorMessage:P,children:e.jsx(j,{placeholder:"10-digit phone number",className:"h-12 bg-white/5 border-white/10 rounded-xl focus:border-primary/50 text-gray-100 placeholder:text-gray-300/60 transition-all font-medium",value:i,onChange:a=>h(a.target.value)})}),e.jsx("div",{id:"recaptcha-container",className:"hidden"}),e.jsx(m,{className:"w-full h-12 bg-primary hover:bg-primary text-black font-bold rounded-xl shadow-xl shadow-primary/10 transition-all hover:scale-[1.02] active:scale-95 duration-200",onClick:Q,disabled:r,children:r?"TRANSMITTING OTP...":"SEND SECURE OTP"}),e.jsxs("p",{className:"text-[10px] text-gray-200 text-center uppercase tracking-wider font-medium leading-relaxed",children:["A 6-digit verification code will be sent ",e.jsx("br",{})," to your device via SMS."]})]})})})]})};async function be(){const t=await me(),r=await S(t),n=await R.fetchDataWithAxios({method:"post",url:F.googleSignIn,data:{login_type_id:1,payload:{id_token:r}}});return W(n)}async function we(){const t=await he(),r=await S(t),n=await R.fetchDataWithAxios({method:"post",url:F.githubSignIn,data:{login_type_id:2,payload:{id_token:r}}});return W(n)}const ye=({setMessage:t,disableSubmit:r})=>{const{oAuthSignIn:n}=H(),o=async()=>{r||n(async({redirect:i,onSignIn:h})=>{try{const s=await be();if(s){const{token:p,user:c}=s;h({accessToken:p},c),i()}}catch(s){t==null||t((s==null?void 0:s.toString())||"")}})},l=async()=>{r||n(async({redirect:i,onSignIn:h})=>{try{const s=await we();if(s){const{token:p,user:c}=s;h({accessToken:p},c),i()}}catch(s){t==null||t((s==null?void 0:s.toString())||"")}})};return e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(m,{className:"w-full h-12 bg-white/5 border border-white/10 text-gray-100 hover:bg-white/10 hover:border-white/20 shadow-xl transition-all duration-300 rounded-xl px-2 flex items-center justify-center gap-3 group",type:"button",onClick:o,disabled:r,children:[e.jsx("div",{className:"bg-white p-1 rounded-full transition-transform group-hover:scale-110 duration-300",children:e.jsx("img",{className:"h-5 w-5",src:"/img/others/google.png",alt:"Google"})}),e.jsx("span",{className:"font-bold tracking-tight",children:"Google"})]}),e.jsxs(m,{className:"w-full h-12 bg-white/5 border border-white/10 text-gray-100 hover:bg-white/10 hover:border-white/20 shadow-xl transition-all duration-300 rounded-xl px-2 flex items-center justify-center gap-3 group",type:"button",onClick:l,disabled:r,children:[e.jsx("div",{className:"bg-gray-900 p-1 rounded-full border border-white/10 transition-transform group-hover:scale-110 duration-300",children:e.jsx("img",{className:"h-5 w-5 invert",src:"/img/others/github.png",alt:"GitHub"})}),e.jsx("span",{className:"font-bold tracking-tight",children:"GitHub"})]})]})},ve=({signUpUrl:t="/sign-up",forgetPasswordUrl:r="/forgot-password",disableSubmit:n})=>{const[o,l]=ce();return e.jsxs("div",{className:"animate-in fade-in duration-1000",children:[e.jsxs("div",{className:"mb-10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary mb-3 font-bold tracking-[0.3em] text-[10px] uppercase",children:[e.jsx("div",{className:"w-5 h-[2px] bg-primary rounded-full transition-all duration-500 hover:w-10"}),"Access Terminal"]}),e.jsx("h2",{className:"text-4xl font-black text-white mb-2 tracking-tight",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-100 font-medium text-sm",children:"Enter your credentials to access the 3D Studio."})]}),o&&e.jsx("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/20 rounded-xl",children:e.jsxs("span",{className:"text-red-400 text-sm font-bold flex items-center gap-2 italic",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse"}),o]})}),e.jsx(fe,{disableSubmit:n,setMessage:l,passwordHint:e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx(ue,{to:r,className:"text-[10px] font-bold text-gray-300/60 uppercase tracking-widest hover:text-primary transition-colors",themeColor:!1,children:"Forgot Password"})})}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"relative flex items-center justify-center mb-8",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-white/20"})}),e.jsx("span",{className:"relative px-4 bg-gray-950 text-[10px] font-black text-gray-100 uppercase tracking-[0.4em]",children:"Rapid Access"})]}),e.jsx(ye,{disableSubmit:n,setMessage:l})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t border-white/20 text-center",children:[e.jsx("span",{className:"text-gray-100 text-xs font-semibold uppercase tracking-widest",children:"New to the studio?"}),e.jsx(se,{to:t,className:"ml-2 text-xs font-black text-primary hover:text-white transition-all uppercase tracking-widest underline decoration-primary/20 underline-offset-4 decoration-2",children:"Create Account"})]})]})},Ae=()=>e.jsx(ve,{});export{ve as SignInBase,Ae as default};
