import{r as a,j as e}from"./index-B-yiBXzM.js";import{B as b,C as fe,M as ue,L as O,S as G,a as xe,b as ye,c as be,d as we,e as je,f as ve,g as ke,h as Me,R as $,U as X,i as Le,j as ze,k as Ne,G as Ae,l as Se,O as Ue,E as Pe,m as Ce,n as Re,o as Ie,t as F,p as Oe}from"./renderUtils-B9w9cBt2.js";import{c as Ee,a as Te,B as w}from"./index-C5YOWs5V.js";import{c as N}from"./createLucideIcon-CvgFFI-i.js";import{D as _e,C as De}from"./card-nzq7r7e3.js";import"./floating-ui.react-dom-DLM0FT_M.js";import"./index-Cs0IGsSJ.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ge=N("circle-check-big",Qe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],Be=N("cpu",He);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M2 21V3",key:"1bzk4w"}],["path",{d:"M2 5h18a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2.26",key:"1d64pi"}],["path",{d:"M7 17v3a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1v-3",key:"5hbqbf"}],["circle",{cx:"16",cy:"11",r:"2",key:"qt15rb"}],["circle",{cx:"8",cy:"11",r:"2",key:"ssideg"}]],qe=N("gpu",Fe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Ve=N("lightbulb",$e);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],W=N("rotate-ccw",Ye);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],We=N("sliders-horizontal",Xe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M12.034 12.681a.498.498 0 0 1 .647-.647l9 3.5a.5.5 0 0 1-.033.943l-3.444 1.068a1 1 0 0 0-.66.66l-1.067 3.443a.5.5 0 0 1-.943.033z",key:"xwnzip"}],["path",{d:"M5 17A12 12 0 0 1 17 5",key:"1okkup"}],["circle",{cx:"19",cy:"5",r:"2",key:"mhkx31"}],["circle",{cx:"5",cy:"19",r:"2",key:"v8kfzx"}]],Je=N("spline-pointer",Ze),Ke=({skinImage:r,pose:t})=>{const i=a.useRef(null),n=a.useRef(null),m=a.useRef(null),l=a.useRef(null),o=a.useRef(null),h=a.useRef(null),x=a.useRef(null),j=a.useRef(null),g=a.useRef(null),v=a.useRef(null),c=a.useRef(null);a.useEffect(()=>{n.current&&n.current.rotation.set(t.head.x*Math.PI/180,t.head.y*Math.PI/180,t.head.z*Math.PI/180),m.current&&m.current.rotation.set(t.body.x*Math.PI/180,t.body.y*Math.PI/180,t.body.z*Math.PI/180),l.current&&l.current.rotation.set(t.leftUpperArm.x*Math.PI/180,t.leftUpperArm.y*Math.PI/180,t.leftUpperArm.z*Math.PI/180),o.current&&o.current.rotation.set(t.leftLowerArm.x*Math.PI/180,t.leftLowerArm.y*Math.PI/180,t.leftLowerArm.z*Math.PI/180),h.current&&h.current.rotation.set(t.rightUpperArm.x*Math.PI/180,t.rightUpperArm.y*Math.PI/180,t.rightUpperArm.z*Math.PI/180),x.current&&x.current.rotation.set(t.rightLowerArm.x*Math.PI/180,t.rightLowerArm.y*Math.PI/180,t.rightLowerArm.z*Math.PI/180),j.current&&j.current.rotation.set(t.leftUpperLeg.x*Math.PI/180,t.leftUpperLeg.y*Math.PI/180,t.leftUpperLeg.z*Math.PI/180),g.current&&g.current.rotation.set(t.leftLowerLeg.x*Math.PI/180,t.leftLowerLeg.y*Math.PI/180,t.leftLowerLeg.z*Math.PI/180),v.current&&v.current.rotation.set(t.rightUpperLeg.x*Math.PI/180,t.rightUpperLeg.y*Math.PI/180,t.rightUpperLeg.z*Math.PI/180),c.current&&c.current.rotation.set(t.rightLowerLeg.x*Math.PI/180,t.rightLowerLeg.y*Math.PI/180,t.rightLowerLeg.z*Math.PI/180)},[t]);const s=U=>[U.right,U.left,U.top,U.bottom,U.front,U.back].map(([ge,pe,H,B])=>{const Q=document.createElement("canvas");Q.width=H*4,Q.height=B*4;const q=Q.getContext("2d");q.imageSmoothingEnabled=!1,q.drawImage(r,ge,pe,H,B,0,0,H*4,B*4);const P=new fe(Q);return P.flipY=!0,P.generateMipmaps=!1,P.magFilter=1003,P.minFilter=1003,P.needsUpdate=!0,new ue({map:P,transparent:!0,alphaTest:.1})}),p=new b(8,8,8),y=new b(8,12,4),L=new b(4,6,4),k=new b(4,6,4),f=new b(4,6,4),z=new b(4,6,4),R=new b(8.5,8.5,8.5),A=new b(8.5,12.5,4.5),E=new b(4.5,6.5,4.5),T=new b(4.5,6.5,4.5),_=new b(4.5,6.5,4.5),d=new b(4.5,6.5,4.5),u=s({right:[0,8,8,8],left:[16,8,8,8],top:[8,0,8,8],bottom:[16,0,8,8],front:[8,8,8,8],back:[24,8,8,8]}),S=s({right:[16,20,4,12],left:[28,20,4,12],top:[20,16,8,4],bottom:[28,16,8,4],front:[20,20,8,12],back:[32,20,8,12]}),M=s({right:[40,26,4,6],left:[48,26,4,6],top:[44,16,4,4],bottom:[48,16,4,4],front:[44,26,4,6],back:[52,26,4,6]}),D=s({right:[40,20,4,6],left:[48,20,4,6],top:[44,16,4,4],bottom:[44,16,4,4],front:[44,20,4,6],back:[52,20,4,6]}),Z=s({right:[32,58,4,6],left:[40,58,4,6],top:[36,48,4,4],bottom:[40,48,4,4],front:[36,58,4,6],back:[44,58,4,6]}),J=s({right:[32,52,4,6],left:[40,52,4,6],top:[36,48,4,4],bottom:[36,48,4,4],front:[36,52,4,6],back:[44,52,4,6]}),K=s({right:[0,26,4,6],left:[8,26,4,6],top:[4,16,4,4],bottom:[8,16,4,4],front:[4,26,4,6],back:[12,26,4,6]}),ee=s({right:[0,20,4,6],left:[8,20,4,6],top:[4,16,4,4],bottom:[4,16,4,4],front:[4,20,4,6],back:[12,20,4,6]}),te=s({right:[16,58,4,6],left:[24,58,4,6],top:[20,48,4,4],bottom:[24,48,4,4],front:[20,58,4,6],back:[28,58,4,6]}),re=s({right:[16,52,4,6],left:[24,52,4,6],top:[20,48,4,4],bottom:[20,48,4,4],front:[20,52,4,6],back:[28,52,4,6]}),se=s({right:[48,8,8,8],left:[32,8,8,8],top:[40,0,8,8],bottom:[48,0,8,8],front:[40,8,8,8],back:[56,8,8,8]}),ae=s({right:[16,36,4,12],left:[28,36,4,12],top:[20,32,8,4],bottom:[28,32,8,4],front:[20,36,8,12],back:[32,36,8,12]}),oe=s({right:[40,42,4,6],left:[48,42,4,6],top:[44,32,4,4],bottom:[48,32,4,4],front:[44,42,4,6],back:[52,42,4,6]}),ie=s({right:[40,36,4,6],left:[48,36,4,6],top:[44,32,4,4],bottom:[44,32,4,4],front:[44,36,4,6],back:[52,36,4,6]}),ne=s({right:[48,58,4,6],left:[56,58,4,6],top:[52,48,4,4],bottom:[56,48,4,4],front:[52,58,4,6],back:[60,58,4,6]}),le=s({right:[48,52,4,6],left:[56,52,4,6],top:[52,48,4,4],bottom:[52,48,4,4],front:[52,52,4,6],back:[60,52,4,6]}),ce=s({right:[0,42,4,6],left:[8,42,4,6],top:[4,32,4,4],bottom:[8,32,4,4],front:[4,42,4,6],back:[12,42,4,6]}),de=s({right:[0,36,4,6],left:[8,36,4,6],top:[4,32,4,4],bottom:[4,32,4,4],front:[4,36,4,6],back:[12,36,4,6]}),me=s({right:[0,58,4,6],left:[8,58,4,6],top:[4,48,4,4],bottom:[8,48,4,4],front:[4,58,4,6],back:[12,58,4,6]}),he=s({right:[0,52,4,6],left:[8,52,4,6],top:[4,48,4,4],bottom:[4,48,4,4],front:[4,52,4,6],back:[12,52,4,6]});return e.jsxs("group",{ref:i,position:[0,-2,0],scale:.12,children:[e.jsxs("group",{ref:n,position:[0,24,0],children:[e.jsx("mesh",{position:[0,4,0],geometry:p,material:u}),e.jsx("mesh",{position:[0,4,0],geometry:R,material:se})]}),e.jsxs("group",{ref:m,position:[0,24,0],children:[e.jsx("mesh",{position:[0,-6,0],geometry:y,material:S}),e.jsx("mesh",{position:[0,-6,0],geometry:A,material:ae})]}),e.jsxs("group",{ref:l,position:[-6,24,0],children:[e.jsx("mesh",{position:[0,-3,0],geometry:L,material:J}),e.jsx("mesh",{position:[0,-3,0],geometry:E,material:le}),e.jsxs("group",{ref:o,position:[0,-6,0],children:[e.jsx("mesh",{position:[0,-3,0],geometry:k,material:Z}),e.jsx("mesh",{position:[0,-3,0],geometry:T,material:ne})]})]}),e.jsxs("group",{ref:h,position:[6,24,0],children:[e.jsx("mesh",{position:[0,-3,0],geometry:L,material:D}),e.jsx("mesh",{position:[0,-3,0],geometry:E,material:ie}),e.jsxs("group",{ref:x,position:[0,-6,0],children:[e.jsx("mesh",{position:[0,-3,0],geometry:k,material:M}),e.jsx("mesh",{position:[0,-3,0],geometry:T,material:oe})]})]}),e.jsxs("group",{ref:j,position:[-2,12,0],children:[e.jsx("mesh",{position:[0,-3,0],geometry:f,material:re}),e.jsx("mesh",{position:[0,-3,0],geometry:_,material:he}),e.jsxs("group",{ref:g,position:[0,-6,0],children:[e.jsx("mesh",{position:[0,-3,0],geometry:z,material:te}),e.jsx("mesh",{position:[0,-3,0],geometry:d,material:me})]})]}),e.jsxs("group",{ref:v,position:[2,12,0],children:[e.jsx("mesh",{position:[0,-3,0],geometry:f,material:ee}),e.jsx("mesh",{position:[0,-3,0],geometry:_,material:de}),e.jsxs("group",{ref:c,position:[0,-6,0],children:[e.jsx("mesh",{position:[0,-3,0],geometry:z,material:K}),e.jsx("mesh",{position:[0,-3,0],geometry:d,material:ce})]})]})]})},et=({pose:r,onPoseChange:t})=>{const i=[{key:"head",label:"Head",color:"text-yellow-400"},{key:"body",label:"Body",color:"text-orange-400"},{key:"leftUpperArm",label:"Left Upper Arm",color:"text-blue-400"},{key:"leftLowerArm",label:"Left Forearm",color:"text-cyan-400"},{key:"rightUpperArm",label:"Right Upper Arm",color:"text-purple-400"},{key:"rightLowerArm",label:"Right Forearm",color:"text-pink-400"},{key:"leftUpperLeg",label:"Left Thigh",color:"text-green-400"},{key:"leftLowerLeg",label:"Left Shin",color:"text-lime-400"},{key:"rightUpperLeg",label:"Right Thigh",color:"text-indigo-400"},{key:"rightLowerLeg",label:"Right Shin",color:"text-violet-400"}],n=[{key:"x",label:"X (Pitch)",color:"text-red-400"},{key:"y",label:"Y (Yaw)",color:"text-green-400"},{key:"z",label:"Z (Roll)",color:"text-blue-400"}];return e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground mb-4",children:"Manual Controls"}),e.jsx("div",{className:"space-y-4 overflow-y-auto",children:i.map(m=>e.jsxs("div",{className:"space-y-2 p-3 bg-muted/20 rounded-lg border border-border/50",children:[e.jsx("h4",{className:`text-sm font-medium ${m.color}`,children:m.label}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:n.map(l=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(O,{className:`text-xs ${l.color} font-medium`,children:l.key.toUpperCase()}),e.jsxs("span",{className:"text-xs text-muted-foreground font-mono",children:[r.poseConfig[m.key][l.key],"Â°"]})]}),e.jsx(G,{value:[r.poseConfig[m.key][l.key]],onValueChange:([o])=>t(m.key,l.key,o),min:-180,max:180,step:5,className:"w-full h-2"})]},l.key))})]},m.key))}),r.facial&&e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("h4",{className:"font-semibold text-foreground mb-2",children:"Facial Controls"}),r.facial.eyes&&e.jsxs("div",{className:"space-y-2 p-3 bg-muted/20 rounded-lg border border-border/50",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-400",children:"Eyes"}),e.jsx(O,{className:"text-xs text-muted-foreground",children:"Blink"}),e.jsx(G,{value:[r.facial.eyes.blink],min:0,max:1,step:.05,className:"w-full h-2"})]}),r.facial.mouth&&e.jsxs("div",{className:"space-y-2 p-3 bg-muted/20 rounded-lg border border-border/50",children:[e.jsx("h4",{className:"text-sm font-medium text-pink-400",children:"Mouth"}),e.jsx(O,{className:"text-xs text-muted-foreground",children:"Smile"}),e.jsx(G,{value:[r.facial.mouth.smile],min:0,max:1,step:.05,className:"w-full h-2"}),e.jsx(O,{className:"text-xs text-muted-foreground",children:"Open"}),e.jsx(G,{value:[r.facial.mouth.open],min:0,max:1,step:.05,className:"w-full h-2"})]})]})]})},tt=Te("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function V({className:r,variant:t,...i}){return e.jsx("div",{className:Ee(tt({variant:t}),r),...i})}const rt={low:"Optimized for low-end devices and mobile",medium:"Balanced quality and performance",high:"Enhanced visuals for desktop",ultra:"Maximum quality for high-end GPUs"},st={low:"ðŸ“±",medium:"ðŸ’»",high:"ðŸ–¥ï¸",ultra:"ðŸš€"},at=({quality:r,autoDetectedQuality:t,isUserOverride:i,onQualityChange:n,onResetToAuto:m,fps:l})=>e.jsx("div",{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h4",{className:"font-semibold text-foreground",children:"Quality Settings"})}),l!==void 0&&e.jsxs(V,{className:"text-white",variant:(l>50||l>30,"default"),children:[Math.round(l)," FPS"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(O,{children:"Rendering Quality"}),i&&e.jsx(V,{variant:"outline",className:"text-xs",children:"Manual"})]}),e.jsxs(xe,{value:r,onValueChange:o=>n(o),children:[e.jsx(ye,{children:e.jsx(be,{})}),e.jsx(we,{className:"bg-white",children:["low","medium","high","ultra"].map(o=>e.jsx(je,{value:o,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:st[o]}),e.jsx("span",{className:"capitalize",children:o}),o===t&&e.jsx(Be,{className:"w-3 h-3 text-muted-foreground"})]})},o))})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:rt[r]})]}),i&&e.jsxs(w,{variant:"outline",size:"sm",onClick:m,className:"w-full flex items-center gap-2",children:[e.jsx(W,{className:"w-3 h-3"}),"Reset to Auto (",t,")"]}),e.jsx("div",{className:"pt-2 border-t border-border",children:e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Auto-detected:"}),e.jsx("span",{className:"font-medium capitalize",children:t})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Active:"}),e.jsx("span",{className:"font-medium capitalize",children:r})]})]})})]})}),ot={low:{shadowMapSize:512,shadowType:"basic",shadowBias:-.001,shadowNormalBias:.05,antialias:!1,pixelRatio:1,toneMapping:!1,toneMappingExposure:1,postProcessing:!1,bloom:!1,ssao:!1,dof:!1,maxLights:2,envMapIntensity:.3,textureAnisotropy:1,lodDistances:[0,5,10]},medium:{shadowMapSize:1024,shadowType:"pcf",shadowBias:-5e-4,shadowNormalBias:.03,antialias:!0,pixelRatio:Math.min(window.devicePixelRatio,1.5),toneMapping:!0,toneMappingExposure:1,postProcessing:!0,bloom:!0,ssao:!1,dof:!1,maxLights:4,envMapIntensity:.6,textureAnisotropy:4,lodDistances:[0,10,20]},high:{shadowMapSize:2048,shadowType:"pcfSoft",shadowBias:-1e-4,shadowNormalBias:.02,antialias:!0,pixelRatio:Math.min(window.devicePixelRatio,2),toneMapping:!0,toneMappingExposure:1.2,postProcessing:!0,bloom:!0,ssao:!0,dof:!1,maxLights:8,envMapIntensity:1,textureAnisotropy:8,lodDistances:[0,15,30]},ultra:{shadowMapSize:4096,shadowType:"pcfSoft",shadowBias:-5e-5,shadowNormalBias:.01,antialias:!0,pixelRatio:Math.min(window.devicePixelRatio,2),toneMapping:!0,toneMappingExposure:1.2,postProcessing:!0,bloom:!0,ssao:!0,dof:!0,maxLights:16,envMapIntensity:1.2,textureAnisotropy:16,lodDistances:[0,20,40]}},it=r=>ot[r],nt=()=>{const[r,t]=a.useState("medium"),[i,n]=a.useState(null),[m,l]=a.useState(60);return a.useEffect(()=>{const v=(()=>{var A;const s=document.createElement("canvas"),p=s.getContext("webgl2")||s.getContext("webgl");if(!p)return"low";const y=p.getParameter(p.RENDERER),L=p.getParameter(p.VENDOR),k=p.getParameter(p.MAX_TEXTURE_SIZE),f=((A=performance.memory)==null?void 0:A.jsHeapSizeLimit)||0,z=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),R=/NVIDIA|GeForce RTX|Radeon RX|Apple M[0-9]|Metal/i.test(y+L);return z?f>2e9?"medium":"low":R&&k>=16384&&f>4e9?"ultra":k>=8192&&f>4e9?"high":k>=4096&&f>2e9?"medium":"low"})();t(v);const c=localStorage.getItem("userQualityPreference");c&&n(c)},[]),{quality:i||r,autoDetectedQuality:r,isUserOverride:i!==null,setQuality:g=>{n(g),localStorage.setItem("userQualityPreference",g)},resetToAuto:()=>{n(null),localStorage.removeItem("userQualityPreference")},fps:m,updateFPS:g=>{l(g)}}},I=(r,t)=>{r.generateMipmaps=!0,r.minFilter=ke,r.magFilter=Me,t&&(r.anisotropy=t.textureAnisotropy),r.wrapS=$,r.wrapT=$,r.needsUpdate=!0},lt=(r,t,i)=>{r.traverse(n=>{if(n.isMesh){const l=n.material;Array.isArray(l)?l.forEach(o=>Y(o,t,i)):Y(l,t,i)}})},Y=(r,t,i)=>{r instanceof ve&&(r.map&&I(r.map,i),r.normalMap&&I(r.normalMap,i),r.roughnessMap&&I(r.roughnessMap,i),r.metalnessMap&&I(r.metalnessMap,i),r.aoMap&&I(r.aoMap,i),r.needsUpdate=!0)},C={standing:{poseConfig:{leftUpperArm:{x:0,y:0,z:0},leftLowerArm:{x:0,y:0,z:0},rightUpperArm:{x:0,y:0,z:0},rightLowerArm:{x:0,y:0,z:0},leftUpperLeg:{x:0,y:0,z:0},leftLowerLeg:{x:0,y:0,z:0},rightUpperLeg:{x:0,y:0,z:0},rightLowerLeg:{x:0,y:0,z:0},head:{x:0,y:0,z:0},body:{x:0,y:0,z:0}},facial:{eyes:{x:0,y:0,blink:0},mouth:{smile:0,open:0},eyebrows:{left:0,right:0}},attachments:{leftHand:{item_code:"sword",offset:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}},rightHand:{item_code:"shield",offset:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}}},poseMeta:{name:"Standing",description:"Neutral relaxed pose with both legs straight.",category:"Idle",tags:["neutral","idle","standing"],isSymmetrical:!0,difficulty:"easy",previewImgUrl:"./poseLabsPose/standing.png"}},walking:{poseConfig:{leftUpperArm:{x:-20,y:0,z:-5},leftLowerArm:{x:-5,y:0,z:5},rightUpperArm:{x:20,y:0,z:5},rightLowerArm:{x:0,y:0,z:0},leftUpperLeg:{x:25,y:0,z:-3},leftLowerLeg:{x:0,y:0,z:0},rightUpperLeg:{x:-25,y:0,z:5},rightLowerLeg:{x:0,y:0,z:0},head:{x:0,y:2,z:5},body:{x:0,y:0,z:0}},facial:{eyes:{x:0,y:0,blink:0},mouth:{smile:0,open:0},eyebrows:{left:0,right:0}},attachments:{leftHand:{item_code:"sword",offset:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}},rightHand:{item_code:"shield",offset:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}}},poseMeta:{name:"Walking",description:"A natural stride with swinging arms.",category:"Movement",tags:["walk","move","stride"],isSymmetrical:!1,difficulty:"easy",previewImgUrl:"./poseLabsPose/walking.png"}},waving:{poseConfig:{leftUpperArm:{x:0,y:0,z:0},leftLowerArm:{x:0,y:0,z:0},rightUpperArm:{x:-80,y:0,z:30},rightLowerArm:{x:-45,y:0,z:15},leftUpperLeg:{x:0,y:0,z:0},leftLowerLeg:{x:0,y:0,z:0},rightUpperLeg:{x:0,y:0,z:0},rightLowerLeg:{x:0,y:0,z:0},head:{x:0,y:15,z:0},body:{x:0,y:0,z:0}},facial:{eyes:{x:0,y:5,blink:0},mouth:{smile:1,open:0},eyebrows:{left:5,right:5}},attachments:{leftHand:{item_code:"",offset:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}},rightHand:{item_code:"",offset:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}}},poseMeta:{name:"Waving",description:"Friendly wave with right hand raised.",category:"Greeting",tags:["wave","hello","interaction"],isSymmetrical:!1,difficulty:"medium",previewImgUrl:"./poseLabsPose/waving.png"}},sitting:{poseConfig:{leftUpperArm:{x:0,y:0,z:0},leftLowerArm:{x:-30,y:0,z:0},rightUpperArm:{x:0,y:0,z:0},rightLowerArm:{x:-30,y:0,z:0},leftUpperLeg:{x:-45,y:0,z:0},leftLowerLeg:{x:45,y:0,z:0},rightUpperLeg:{x:-45,y:0,z:0},rightLowerLeg:{x:45,y:0,z:0},head:{x:0,y:0,z:0},body:{x:0,y:0,z:0}},facial:{eyes:{x:0,y:0,blink:0},mouth:{smile:.2,open:0},eyebrows:{left:0,right:0}},attachments:{leftHand:{item_code:"",offset:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}},rightHand:{item_code:"",offset:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}}},poseMeta:{name:"Sitting",description:"Character in a relaxed sitting position.",category:"Idle",tags:["sit","rest","idle"],isSymmetrical:!0,difficulty:"easy",previewImgUrl:"./poseLabsPose/sitting.png"}},running:{poseConfig:{leftUpperArm:{x:-45,y:0,z:0},leftLowerArm:{x:0,y:0,z:0},rightUpperArm:{x:45,y:0,z:0},rightLowerArm:{x:0,y:0,z:0},leftUpperLeg:{x:45,y:0,z:0},leftLowerLeg:{x:0,y:0,z:0},rightUpperLeg:{x:-45,y:0,z:0},rightLowerLeg:{x:0,y:0,z:0},head:{x:5,y:0,z:0},body:{x:5,y:0,z:0}},facial:{eyes:{x:0,y:0,blink:0},mouth:{smile:0,open:.3},eyebrows:{left:0,right:0}},attachments:{leftHand:{item_code:"sword",offset:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}},rightHand:{item_code:"",offset:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}}},poseMeta:{name:"Running",description:"Dynamic running motion with forward lean.",category:"Movement",tags:["run","sprint","motion"],isSymmetrical:!1,difficulty:"medium",previewImgUrl:"./poseLabsPose/running.png"}},combat:{poseConfig:{leftUpperArm:{x:-45,y:30,z:0},leftLowerArm:{x:-90,y:0,z:0},rightUpperArm:{x:-30,y:-45,z:15},rightLowerArm:{x:-60,y:0,z:0},leftUpperLeg:{x:15,y:0,z:0},leftLowerLeg:{x:0,y:0,z:0},rightUpperLeg:{x:-15,y:0,z:0},rightLowerLeg:{x:0,y:0,z:0},head:{x:0,y:-15,z:0},body:{x:0,y:-10,z:0}},facial:{eyes:{x:0,y:-5,blink:0},mouth:{smile:0,open:.2},eyebrows:{left:-5,right:-5}},attachments:{leftHand:{item_code:"shield",offset:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}},rightHand:{item_code:"sword",offset:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}}},poseMeta:{name:"Combat Ready",description:"Aggressive stance prepared for battle.",category:"Action",tags:["combat","fight","battle"],isSymmetrical:!1,difficulty:"hard",previewImgUrl:"./poseLabsPose/combat.png"}}},ct=({skinImage:r,onChangeSkinClick:t,pose:i})=>{const[n,m]=a.useState(i||C.standing),[l,o]=a.useState(Object.keys(C).find(d=>C[d]===i)||"standing"),[h,x]=a.useState(null),j=a.useRef(null),[g,v]=a.useState(null),[c,s]=a.useState(null),[p,y]=a.useState(!1),[L,k]=a.useState([{id:"light-1",type:"directional",position:[10,10,5],color:"#ffffff",intensity:1.2},{id:"light-2",type:"directional",position:[-10,5,-5],color:"#fffff",intensity:.3}]),f=nt(),z=it(f.quality);a.useEffect(()=>{g&&lt(g,void 0,z)},[g,z]);const R=(d,u,S)=>{m(M=>({...M,poseConfig:{...M.poseConfig,[d]:{...M.poseConfig[d],[u]:S}}})),o("custom")},A=d=>{m(C[d]),o(d)},E=()=>{m(C.standing),o("standing"),F("Pose reset to standing")},T=()=>{const d=j.current;if(!d)return F.error("Canvas not found");const u=document.createElement("a");u.download="minecraft-character.png",u.href=d.toDataURL("image/png"),u.click(),F.success("Screenshot saved!")},_=async(d,u)=>{if(!g||!c)throw new Error("Scene not ready");return await Oe(g,c,d,u)};return e.jsxs("div",{className:"relative w-full h-full bg-white flex overflow-hidden",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"absolute z-20 flex justify-between items-center bg-white rounded-br-xl backdrop-blur-sm p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(w,{variant:"outline",size:"sm",onClick:d=>t(d.currentTarget),children:[e.jsx(X,{className:"w-4 h-4 mr-1"})," Change Skin"]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:T,children:[e.jsx(Le,{className:"w-4 h-4 mr-1"})," Screenshot"]}),e.jsxs(w,{variant:"default",size:"sm",onClick:()=>y(!0),children:[e.jsx(_e,{className:"w-4 h-4 mr-1"})," HQ Render"]})]})}),e.jsxs("div",{className:"absolute flex flex-col items-center top-16 z-10 border-gray-400 rounded-br-xl rounded-tr-xl bg-white w-14 p-2 space-y-4",children:[e.jsx(w,{variant:h==="quality"?"default":"ghost",size:"icon",onClick:()=>x(h==="quality"?null:"quality"),children:e.jsx(qe,{className:"w-4 h-4"})}),e.jsx(w,{variant:h==="lighting"?"default":"ghost",size:"icon",onClick:()=>x(h==="lighting"?null:"lighting"),children:e.jsx(Ve,{className:"w-4 h-4"})}),e.jsx(w,{variant:h==="poses"?"default":"ghost",size:"icon",onClick:()=>x(h==="poses"?null:"poses"),children:e.jsx(Je,{className:"w-4 h-4"})}),e.jsx(w,{variant:h==="poseControls"?"default":"ghost",size:"icon",onClick:()=>x(h==="poseControls"?null:"poseControls"),children:e.jsx(We,{className:"w-4 h-4"})})]}),e.jsxs(ze,{ref:j,camera:{position:[5,0,8],fov:45},className:"sm:w-auto bg-gray-950 border border-gray-300",gl:{preserveDrawingBuffer:!0,antialias:!0},onCreated:({scene:d,camera:u})=>{v(d),s(u)},children:[e.jsx("ambientLight",{intensity:.5}),e.jsx(Ne,{lights:L}),e.jsx(Ae,{alignment:"bottom-left",margin:[80,80],children:e.jsx(Se,{axisColors:["#ff3653","#8adb00","#2c8fff"],labelColor:"white"})}),e.jsx(Ke,{skinImage:r,pose:n.poseConfig}),e.jsx(Ue,{enablePan:!0,enableZoom:!0,enableRotate:!0}),e.jsx(Pe,{preset:"sunset"})]}),e.jsx("div",{className:"absolute bottom-2 right-2",children:e.jsx(Ce,{className:"!top-auto !bottom-0 !right-0"})})]}),e.jsxs("div",{className:`absolute bg-white top-0 bottom-0 right-0 z-10 w-80 p-4 overflow-y-auto border-border transition-transform duration-600 ease-in-out
          ${h?"translate-x-0":"translate-x-[calc(100%+4rem)]"}`,children:[h==="quality"&&e.jsx(at,{quality:f.quality,autoDetectedQuality:f.autoDetectedQuality,isUserOverride:f.isUserOverride,onQualityChange:f.setQuality,onResetToAuto:f.resetToAuto,fps:f.fps}),h==="lighting"&&e.jsx(Re,{lights:L,onLightsChange:k}),h==="poses"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-3 justify-between",children:[e.jsx("h4",{className:"font-semibold",children:"Preset Poses"}),e.jsx(w,{size:"sm",onClick:E,children:e.jsx(W,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(C).map(([d,u])=>{var S,M,D;return e.jsxs("div",{onClick:()=>A(d),className:`cursor-pointer text-center text-xs rounded-lg border border-gray-400 overflow-hidden hover:bg-muted/40 transition
      ${l===d?"ring-2 ring-green-500":""}`,children:[e.jsx("img",{src:((S=u.poseMeta)==null?void 0:S.previewImgUrl)||"./poseLabsPose/placeholder-pose.png",alt:((M=u.poseMeta)==null?void 0:M.name)||d,className:"w-full h-24 object-cover bg-gray-500",loading:"lazy"}),e.jsx("div",{className:"p-1 font-medium",children:((D=u.poseMeta)==null?void 0:D.name)||d})]},d)})})]}),h==="poseControls"&&e.jsx(et,{pose:n,onPoseChange:R})]}),e.jsx(Ie,{open:p,onOpenChange:y,onRender:_})]})},dt=({onSkinUpload:r})=>{const[t,i]=a.useState(!1),[n,m]=a.useState(null),l=a.useRef(null),o=c=>c.type.includes("png")?c.size>5*1024*1024?(alert("File size should be less than 5MB"),!1):!0:(alert("Please upload a PNG file"),!1),h=c=>new Promise((s,p)=>{const y=new Image;y.onload=()=>{if(y.width!==64||y.height!==64){p(new Error("Skin must be 64x64 pixels"));return}s(y)},y.onerror=()=>p(new Error("Failed to load image")),y.src=URL.createObjectURL(c)}),x=async c=>{if(o(c))try{const s=await h(c),p=URL.createObjectURL(c);m({file:c,image:s,preview:p})}catch(s){alert(s instanceof Error?s.message:"Failed to load skin")}},j=c=>{c.preventDefault(),i(!1);const s=Array.from(c.dataTransfer.files);s.length>0&&x(s[0])},g=c=>{const s=c.target.files;s&&s.length>0&&x(s[0])},v=()=>{n&&r(n.file,n.image)};return e.jsxs(De,{className:"w-full p-4 shadow-lg rounded-xl bg-gradient-to-br from-gray-800 via-gray-900 to-gray-950",children:[e.jsx("div",{className:`
      border-2 border-dashed rounded-xl p-6 text-center transition-all cursor-pointer
      ${t?"border-primary bg-primary/10 shadow-lg":"border-border hover:border-primary/50 hover:bg-primary/5"}
    `,onDragOver:c=>{c.preventDefault(),i(!0)},onDragLeave:()=>i(!1),onDrop:j,onClick:()=>{var c;return(c=l.current)==null?void 0:c.click()},children:n?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-24 h-24 border border-border rounded-lg overflow-hidden bg-gray-900",children:e.jsx("img",{src:n.preview,alt:"Uploaded skin",className:"w-full h-full object-contain pixel-art",style:{imageRendering:"pixelated"}})}),e.jsxs("div",{className:"flex items-center gap-2 text-primary font-semibold",children:[e.jsx(Ge,{className:"w-5 h-5"})," ",n.file.name]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"64x64 PNG â€¢ Ready"})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(X,{className:"w-10 h-10 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-foreground font-medium",children:"Drop skin or click to upload"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"PNG â€¢ 64x64 pixels"})]})}),e.jsx("input",{ref:l,type:"file",accept:".png",className:"hidden",onChange:g}),n&&e.jsx(w,{className:"w-full mt-4 bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 text-white hover:shadow-xl transition-all",size:"sm",onClick:v,children:"Load Skin"})]})},yt=()=>{const[r,t]=a.useState(null),[i,n]=a.useState(!1);a.useEffect(()=>{(async()=>{const o=new Image;o.crossOrigin="anonymous",o.src="/skins/default-skin.png",await new Promise((h,x)=>{o.onload=h,o.onerror=x}),t({image:o})})()},[]);const m=(l,o)=>{t({file:l,image:o}),n(!1)};return r?e.jsxs("div",{className:"relative h-[92.2vh] w-full flex flex-col items-center justify-center",children:[e.jsx(ct,{skinImage:r.image,onChangeSkinClick:()=>n(!0)}),i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-2x mx-auto relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-muted-foreground hover:text-foreground",onClick:()=>n(!1),children:"âœ•"}),e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-4 text-center",children:"Upload New Skin"}),e.jsx(dt,{onSkinUpload:m})]})})]}):null};export{yt as default};
