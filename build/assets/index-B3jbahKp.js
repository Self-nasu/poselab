import{K as J,M as j,N as M,O as E,P as X,Q as ee,r as u,E as _,j as e,q as te,T as re,U as R,V as H,W as F,L as ae}from"./index-wHMWyiMA.js";import{I as v}from"./index-oGx8cbtY.js";import{c as N,B as m}from"./index-xPSM5tdS.js";import{u as se,F as ne,a as y,C as A,t as ie,o as oe,s as G,b as le}from"./useTimeOutMessage-CvXacEMN.js";import{P as ce}from"./PasswordInput-CG3kj1qr.js";import{A as de}from"./ActionLink-DeEgRyeb.js";import"./classNames-opE9Ub6X.js";import"./index-Clrwzw4U.js";const W=new X;W.setCustomParameters({prompt:"select_account"});const V=new ee;V.setCustomParameters({allow_signup:"true",prompt:"consent"});async function ue(){try{return await E(j,W)}catch(t){throw console.error("Google sign-in error:",t),new Error(t.message||"Google sign-in failed")}}async function me(){try{console.log("Opening GitHub sign-in popup...");const t=await E(j,V);return console.log("GitHub sign-in successful:",t.user.email),t}catch(t){throw console.error("GitHub sign-in error:",t),new Error(t.message||"GitHub sign-in failed")}}async function he(t){const r=new J(j,"recaptcha-container",{size:"invisible"});return M(j,t,r)}async function pe(t,r){return t.confirm(r)}async function k(t){return await t.user.getIdToken()}const xe=oe({email:G({required_error:"Please enter your email"}).min(1,{message:"Please enter your email"}),password:G({required_error:"Please enter your password"}).min(1,{message:"Please enter your password"})}),ge=t=>{var C,O;const[r,n]=u.useState(!1),[o,l]=u.useState("email"),[i,h]=u.useState(""),[s,p]=u.useState(""),[c,S]=u.useState(null),[I,f]=u.useState(""),{disableSubmit:B=!1,className:U,setMessage:d,passwordHint:P}=t,{handleSubmit:D,formState:{errors:b},control:T}=se({defaultValues:{email:"",password:""},resolver:ie(xe)}),{signIn:L,oAuthSignIn:q}=_(),z=async a=>{const{email:x,password:w}=a;if(!B){n(!0);const g=await L({email:x,password:w});(g==null?void 0:g.status)==="failed"&&(d==null||d("invalid credentials"))}n(!1)},Z=async()=>{if(!i){f("Please enter a phone number");return}f(""),n(!0);try{const a=i.startsWith("+91")?i:`+91${i}`,x=await he(a);S(x),d==null||d("OTP Sent!")}catch(a){console.error("Error sending OTP:",a),f(a.message||"Failed to send OTP")}finally{n(!1)}},K=async()=>{if(!(!s||!c)){n(!0);try{const a=await pe(c,s),x=await k(a),w=await re({id_token:x});if(w){const{token:g,user:Q}=w;q(({onSignIn:Y,redirect:$})=>{Y({accessToken:g},Q),$()})}}catch(a){console.error("Error verifying OTP:",a),f(a.message||"Failed to verify OTP")}finally{n(!1)}}};return e.jsxs("div",{className:N(U,"animate-in fade-in slide-in-from-bottom-4 duration-700"),children:[e.jsxs("div",{className:"flex p-1.5 bg-white/5 border border-white/5 rounded-2xl mb-8",children:[e.jsx("button",{className:N("flex-1 flex items-center justify-center gap-2 py-3 text-xs font-bold tracking-widest uppercase transition-all duration-300 rounded-xl rounded-r-none",o==="email"?"bg-primary text-black shadow-[0_0_20px_rgba(34,197,94,0.3)]":"text-gray-100 hover:text-gray-100"),onClick:()=>l("email"),children:"Email Access"}),e.jsx("button",{className:N("flex-1 flex items-center justify-center gap-2 py-3 text-xs font-bold tracking-widest uppercase transition-all duration-300 rounded-xl rounded-l-none",o==="phone"?"bg-primary text-black shadow-[0_0_20px_rgba(34,197,94,0.3)]":"text-gray-100 hover:text-gray-100"),onClick:()=>l("phone"),children:"Secure SMS"})]}),e.jsx("div",{className:"space-y-6",children:o==="email"?e.jsxs(ne,{onSubmit:D(z),children:[e.jsx(y,{label:e.jsx("span",{className:"text-gray-100 text-[10px] font-bold tracking-widest uppercase",children:"Email Address"}),invalid:!!b.email,errorMessage:(C=b.email)==null?void 0:C.message,children:e.jsx(A,{name:"email",control:T,render:({field:a})=>e.jsx(v,{type:"email",className:"h-12 bg-white/5 border-white/10 rounded-xl focus:border-primary/50 text-gray-100 placeholder:text-gray-300/60 transition-all font-medium pr-10",placeholder:"commander@poselab.gg",autoComplete:"off",...a})})}),e.jsx(y,{label:e.jsx("span",{className:"text-gray-100 text-[10px] font-bold tracking-widest uppercase",children:"Secret Password"}),invalid:!!b.password,errorMessage:(O=b.password)==null?void 0:O.message,className:te(P?"mb-0":""),children:e.jsx(A,{name:"password",control:T,rules:{required:!0},render:({field:a})=>e.jsx(ce,{placeholder:"••••••••",...a})})}),e.jsx("div",{className:"flex justify-start",children:P}),e.jsx(m,{variant:"default",type:"submit",className:"w-full h-12 bg-primary hover:bg-primary text-black font-bold rounded-xl shadow-xl shadow-primary/10 transition-all hover:scale-[1.02] active:scale-95 duration-200 mt-4",disabled:r,children:r?"AUTHORIZING...":"SIGN IN TO STUDIO"})]}):e.jsx("div",{className:"space-y-6",children:c?e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(y,{label:e.jsx("span",{className:"text-gray-400 text-[10px] font-bold tracking-widest uppercase",children:"Verification Code"}),children:e.jsx(v,{className:"h-14 text-center text-3xl font-black tracking-[0.5em] bg-white/5 border-white/10 rounded-xl focus:border-primary/50 text-primary placeholder:text-gray-800 transition-all",placeholder:"000000",maxLength:6,value:s,onChange:a=>p(a.target.value)})}),e.jsx(m,{className:"w-full h-12 bg-primary hover:bg-primary text-black font-bold rounded-xl shadow-xl shadow-primary/10 transition-all hover:scale-[1.02] active:scale-95 duration-200",onClick:K,disabled:r,children:r?"VERIFYING...":"COMPLETE AUTHORIZATION"}),e.jsx(m,{variant:"ghost",size:"sm",className:"w-full text-xs text-gray-500 hover:text-white hover:bg-white/5 h-10 rounded-xl font-bold tracking-widest uppercase",onClick:()=>S(null),children:"Change Phone"})]}):e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(y,{label:e.jsx("span",{className:"text-gray-100 text-[10px] font-bold tracking-widest uppercase",children:"Phone "}),invalid:!!I,errorMessage:I,children:e.jsx(v,{placeholder:"10-digit phone number",className:"h-12 bg-white/5 border-white/10 rounded-xl focus:border-primary/50 text-gray-100 placeholder:text-gray-300/60 transition-all font-medium",value:i,onChange:a=>h(a.target.value)})}),e.jsx("div",{id:"recaptcha-container",className:"hidden"}),e.jsx(m,{className:"w-full h-12 bg-primary hover:bg-primary text-black font-bold rounded-xl shadow-xl shadow-primary/10 transition-all hover:scale-[1.02] active:scale-95 duration-200",onClick:Z,disabled:r,children:r?"TRANSMITTING OTP...":"SEND SECURE OTP"}),e.jsxs("p",{className:"text-[10px] text-gray-200 text-center uppercase tracking-wider font-medium leading-relaxed",children:["A 6-digit verification code will be sent ",e.jsx("br",{})," to your device via SMS."]})]})})})]})};async function fe(){const t=await ue(),r=await k(t),n=await R.fetchDataWithAxios({method:"post",url:H.googleSignIn,data:{login_type_id:1,payload:{id_token:r}}});return F(n)}async function be(){const t=await me(),r=await k(t),n=await R.fetchDataWithAxios({method:"post",url:H.githubSignIn,data:{login_type_id:2,payload:{id_token:r}}});return F(n)}const we=({setMessage:t,disableSubmit:r})=>{const{oAuthSignIn:n}=_(),o=async()=>{r||n(async({redirect:i,onSignIn:h})=>{try{const s=await fe();if(s){const{token:p,user:c}=s;h({accessToken:p},c),i()}}catch(s){t==null||t((s==null?void 0:s.toString())||"")}})},l=async()=>{r||n(async({redirect:i,onSignIn:h})=>{try{const s=await be();if(s){const{token:p,user:c}=s;h({accessToken:p},c),i()}}catch(s){t==null||t((s==null?void 0:s.toString())||"")}})};return e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(m,{className:"w-full h-12 bg-white/5 border border-white/10 text-gray-100 hover:bg-white/10 hover:border-white/20 shadow-xl transition-all duration-300 rounded-xl px-2 flex items-center justify-center gap-3 group",type:"button",onClick:o,disabled:r,children:[e.jsx("div",{className:"bg-white p-1 rounded-full transition-transform group-hover:scale-110 duration-300",children:e.jsx("img",{className:"h-5 w-5",src:"/img/others/google.png",alt:"Google"})}),e.jsx("span",{className:"font-bold tracking-tight",children:"Google"})]}),e.jsxs(m,{className:"w-full h-12 bg-white/5 border border-white/10 text-gray-100 hover:bg-white/10 hover:border-white/20 shadow-xl transition-all duration-300 rounded-xl px-2 flex items-center justify-center gap-3 group",type:"button",onClick:l,disabled:r,children:[e.jsx("div",{className:"bg-gray-900 p-1 rounded-full border border-white/10 transition-transform group-hover:scale-110 duration-300",children:e.jsx("img",{className:"h-5 w-5 invert",src:"/img/others/github.png",alt:"GitHub"})}),e.jsx("span",{className:"font-bold tracking-tight",children:"GitHub"})]})]})},ye=({signUpUrl:t="/sign-up",forgetPasswordUrl:r="/forgot-password",disableSubmit:n})=>{const[o,l]=le();return e.jsxs("div",{className:"animate-in fade-in duration-1000",children:[e.jsxs("div",{className:"mb-10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary mb-3 font-bold tracking-[0.3em] text-[10px] uppercase",children:[e.jsx("div",{className:"w-5 h-[2px] bg-primary rounded-full transition-all duration-500 hover:w-10"}),"Access Terminal"]}),e.jsx("h2",{className:"text-4xl font-black text-white mb-2 tracking-tight",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-100 font-medium text-sm",children:"Enter your credentials to access the 3D Studio."})]}),o&&e.jsx("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/20 rounded-xl",children:e.jsxs("span",{className:"text-red-400 text-sm font-bold flex items-center gap-2 italic",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse"}),o]})}),e.jsx(ge,{disableSubmit:n,setMessage:l,passwordHint:e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx(de,{to:r,className:"text-[10px] font-bold text-gray-300/60 uppercase tracking-widest hover:text-primary transition-colors",themeColor:!1,children:"Forgot Password"})})}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"relative flex items-center justify-center mb-8",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-white/20"})}),e.jsx("span",{className:"relative px-4 bg-gray-950 text-[10px] font-black text-gray-100 uppercase tracking-[0.4em]",children:"Rapid Access"})]}),e.jsx(we,{disableSubmit:n,setMessage:l})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t border-white/20 text-center",children:[e.jsx("span",{className:"text-gray-100 text-xs font-semibold uppercase tracking-widest",children:"New to the studio?"}),e.jsx(ae,{to:t,className:"ml-2 text-xs font-black text-primary hover:text-white transition-all uppercase tracking-widest underline decoration-primary/20 underline-offset-4 decoration-2",children:"Create Account"})]})]})},Ce=()=>e.jsx(ye,{});export{ye as SignInBase,Ce as default};
